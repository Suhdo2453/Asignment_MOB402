<%- include('../inc/header') %>
    <div class="container mt-5" style="min-height: 100vh;">
        <h1 class="border-bottom" style=" margin-top: 70px;">
            <%= title %>
        </h1>
        <button type="button" class="btn btn-primary mb-3" data-toggle="modal" data-target="#exampleModalAccount">
            Add Account
        </button>
        <table class="table table-striped table-hover table-bordered border-top" id="accountTable">
            <thead>
                <tr>
                    <th scope="col"> ID</th>
                    <th scope="col">Fullname</th>
                    <th scope="col">UserName</th>
                    <th scope="col">Email</th>
                    <th data-orderable="false">
                        Group
                        <select id="group-filter" class="form-select-sm float-end">
                            <option value="">All</option>
                            <option value="Admin">Admin</option>
                            <option value="User">User</option>
                        </select>
                    </th>
                    <th scope="col" data-orderable="false">Actions</th>
                </tr>
            </thead>
            <tbody>
                <% accounts.forEach(function(account, index) { %>
                    <tr>
                        <td>
                            <%= index + 1 %>
                        </td>
                        <td>
                            <%= account.full_name %>
                        </td>
                        <td>
                            <%= account.username %>
                        </td>
                        <td>
                            <%= account.email %>
                        </td>
                        <td>
                            <%= account.role %>
                        </td>
                        <td class="dt-center">
                            <button type="button" class="btn btn-sm btn-info edit-btn">
                                <i class="fas fa-edit"></i>
                                Edit
                            </button>
                            <button type="button" class="btn btn-sm btn-danger delete-btn">
                                <i class="fas fa-trash"></i>
                                Delete
                            </button>
                        </td>
                    </tr>
                    <% }); %>
            </tbody>
        </table>
    </div>
    <%- include('../inc/footer') %>

        <!-- Modal xóa sản phẩm -->
        <div class="modal fade" id="deleteModalAccount" tabindex="-1" aria-labelledby="deleteModalLabel"
            aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="deleteModalLabel">Xóa sản phẩm</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <p>Are you sure delete this product?</p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-danger">Delete</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal sửa sản phẩm -->
        <div class="modal fade" id="editModalAccount" tabindex="-1" aria-labelledby="editModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="editModalLabel">Edit Product</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <!-- Form sửa sản phẩm sẽ được load ở đây -->
                        <form class="row g-3">
                            <div class="col-12">
                                <label for="inputAddress" class="form-label">Fullname</label>
                                <input type="text" class="form-control" id="inputAddress">
                            </div>
                            <div class="col-md-6">
                                <label for="inputUserName" class="form-label">UserName</label>
                                <input type="text" class="form-control" id="inputUserName">
                            </div>
                            <div class="col-md-6">
                                <label for="inputPassword4" class="form-label">Password</label>
                                <input type="password" class="form-control" id="inputPassword4">
                            </div>
                            <div class="col-12">
                                <label for="inputEmail" class="form-label">Email</label>
                                <input type="email" class="form-control" id="inputEmail">
                            </div>
                            <div class="col-md-6">
                                <label for="inputGroup" class="form-label">Group</label>
                                <select type="text" class="form-select" id="inputGroup">
                                    <option selected>Choose...</option>
                                    <option>...</option>
                                </select>
                            </div>
                            <div class="col-12">
                                <div class="form-check">
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary">Save Change</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal -->
        <div class="modal fade " id="exampleModalAccount" data-bs-backdrop="static" data-bs-keyboard="false"
            tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Add User</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <form class="row g-3">
                            <div class="col-12">
                                <label for="inputAddress" class="form-label">Fullname</label>
                                <input type="text" class="form-control" id="inputAddress">
                            </div>
                            <div class="col-md-6">
                                <label for="inputUserName" class="form-label">UserName</label>
                                <input type="text" class="form-control" id="inputUserName">
                            </div>
                            <div class="col-md-6">
                                <label for="inputPassword4" class="form-label">Password</label>
                                <input type="password" class="form-control" id="inputPassword4">
                            </div>
                            <div class="col-12">
                                <label for="inputEmail" class="form-label">Email</label>
                                <input type="email" class="form-control" id="inputEmail">
                            </div>
                            <div class="col-md-6">
                                <label for="inputGroup" class="form-label">Group</label>
                                <select type="text" class="form-select" id="inputGroup">
                                    <option selected>Choose...</option>
                                    <option>...</option>
                                </select>
                            </div>
                            <div class="col-12">
                                <div class="form-check">
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary">Save</button>
                    </div>
                </div>
            </div>
        </div>




        <!-- Link các script của datatable và bootstrap -->
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script src="https://cdn.datatables.net/1.11.4/js/jquery.dataTables.min.js"></script>
        <script src="https://cdn.datatables.net/1.11.4/js/dataTables.bootstrap4.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.6.0/js/bootstrap.min.js"></script>
        <script>
            $(document).ready(function () {
                // Khởi tạo DataTables
                var table = $('#accountTable').DataTable({
                    // Cấu hình hiển thị của các cột
                    columnDefs: [
                        { "targets": 0, "className": "text-center align-middle" },
                        { "targets": 1, "className": "text-center align-middle" },
                        { "targets": 2, "className": "text-center align-middle" },
                        { "targets": 3, "className": "text-center align-middle" },
                        { "targets": 4, "className": "text-center align-middle" },
                        { "targets": 5, "className": "text-center align-middle" },
                    ],
                });

                // Thêm tính năng bộ lọc cột cho cột "group"
                table.columns(4).every(function () {
                    var column = this;
                    var select = $('#group-filter');

                    select.on('change', function () {
                        var val = $.fn.dataTable.util.escapeRegex(
                            $(this).val()
                        );

                        column.search(val ? '^' + val + '$' : '', true, false).draw();
                    });
                });

                // Xử lý sự kiện khi click vào nút sửa
                $('#accountTable tbody').on('click', '.edit-btn', function () {
                    var data = table.row($(this).parents('tr')).data();
                    // Hiển thị modal sửa sản phẩm
                    $('#editModalAccount').modal('show');
                    // Load dữ liệu sản phẩm vào form sửa sản phẩm
                    //$('#editModal .modal-body').html('<p>Bạn đang sửa sản phẩm ' + data.name + '</p>');
                });


                // Xử lý sự kiện khi click vào nút xóa
                $('#accountTable tbody').on('click', '.delete-btn', function () {
                    var data = table.row($(this).parents('tr')).data();
                    // Hiển thị modal xóa sản phẩm
                    $('#deleteModalAccount').modal('show');
                    // Load dữ liệu sản phẩm vào modal xóa sản phẩm
                    $('#deleteModalAccount .modal-body').html('<p>Bạn có chắc muốn xóa sản phẩm ' + data.name + '?</p>');
                });

                // Bắt sự kiện click vào nút "Thêm sản phẩm"
                $('#accountTable').on('show.bs.modal', function (event) {
                    // Xử lý khi modal được hiển thị
                });

                // Bắt sự kiện click vào nút "Lưu" trong modal
                $('#accountTable .btn-primary').on('click', function (event) {
                    // Xử lý khi người dùng click vào nút "Lưu"
                });
            });
        </script>